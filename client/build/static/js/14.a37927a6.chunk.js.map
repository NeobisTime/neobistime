{"version":3,"sources":["images/pages/notifications_event_default.png","images/pages/notifications_arrow_pagination.png","components/shared/page-title/index.js","components/shared/page-title/page-title.tsx","components/pages/notifications/notifications.tsx","components/pages/notifications/index.js"],"names":["module","exports","PageTitle","text","className","BlockEventNotification","props","event","poll","useState","willGo","setWillGo","setWillNotGo","setMissedDeadline","correctPollId","setCorrectPollId","deadline","Date","startDate","start","today","submitPoll","finalAnswer","data","id","answer","API","patchPoll","postPoll","then","handleWillGo","useEffect","getMyPoll","correctPoll","filter","title","getTime","src","image","eventImage","alt","getHours","getMinutes","days","getDay","monthListRus","getMonth","getDate","description","address","place","name","to","onClick","withDataContainer","events","setEvents","search","setSearch","period","setPeriod","myPoll","setMyPoll","currentPage","setCurrentPage","pageSize","totalProducts","setTotalProducts","portionSize","next","setNext","pagesCount","Math","ceil","pages","i","push","portionCount","portionNumber","setPortionNumber","leftPortionPageNumber","rightPortionPageNumber","getEvents","results","count","timeOut","type","placeholder","onChange","target","value","options","label","e","notificationArrow","map","key","style","margin","p","page","Notification"],"mappings":"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","file":"static/js/14.a37927a6.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/notifications_event_default.ffb18a39.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAjCAYAAAANDvOtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKaSURBVHgBtZi7ctNAFIb/XUthRk0KaGhcQIELmjQ0eRcKCjfcngVmCBlPILwHdRoXuMCFXYjCFFCkodEMUaTNOR4p4yjSXqTjv5JGq++cWZ3bSoH0+qV5qGJMjMIh3cbK4PJqhMVspjIESpLVlHo7NU/LEs9bnuW5xgUZ+QdPSbLapAn+pONZHJd4MZ2aGJ6SZLVJM8jyPHlQtO5UlyRZ96Tp86xtC0qF8ftX5hk8JMlqk6Y4SrXBH9uia43Ju6kZwyFmFQYbCVabOAzwn7JVAdbgLyhxKOYO4VA5wtKDdeTDamrrLO1IfqUxp0tbeeEkOXYZ8WTBh9WU2r2hlxOG0GVieSc31/hx8k39tawRZbU6G2AEZYGfn8/VLwx32IvV6myIkajE6sNXtZZweGSQfvyilgh1tjZyQIXcAK64yqrulO2bpRwvs6EJ7YyzNnru8iCW09nKyLgykjiWZqbA6uRc/d4Hy8vZykhyUOCIpqlHrrU8aVHSpF1ZHswqsWGnvZ3dMeS7M84sD2VpBIqCf8NJ4GqrLD3CRJIVvLO7op15zKOfZUn26Ux9hxArQk9ZBu1aPHDPIcjqtbNvqAQZSwkqOCk8jzIuFg9FPGswK8hZnvR5gOa5FN2OpqeOTtSXFVK6YupCx5YuxJ9qyUmzL5ZvU3D1d26Tc58D4RCWT7u1wndjat8sNQTO9ZFiagEPSbCivnAqNatTx+AizYr6wCmmFrMzdyJ5spbESuGh0JNCXgX/JYY7GsS656wD7p3x0qxad8LAAb8I+blWnQxEWLVupy5ue1KObltoe8Hv7ShqZ/mTdfTnYLgkq6ltGOiC4I1Uq4YRjqscAZJktTo7unu84Cxd838r9JAkq6moAeYjSDp0B4RZt7oBOtQM7e0qAMAAAAAASUVORK5CYII=\"","import PageTitle from \"./page-title.tsx\";\r\n\r\nexport default PageTitle;\r\n","import React from 'react'\r\ntype textType = {\r\n    text: \"string\"\r\n}\r\n\r\nconst PageTitle = ({ text }: textType) => {\r\n    return (\r\n        <div className='page-title'>\r\n            <p className=\"page-title__text\">\r\n                {text}\r\n            </p>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default PageTitle\r\n","import React, { useState, useEffect } from \"react\";\r\nimport PageTitle from \"../../shared/page-title\";\r\nimport Select from \"react-select\";\r\nimport address from \"../../../images/pages/address.svg\";\r\nimport eventImage from \"../../../images/pages/notifications_event_default.png\";\r\nimport notificationArrow from \"../../../images/pages/notifications_arrow_pagination.png\";\r\nimport Navbar from \"../../shared/navbar\";\r\nimport API from \"../../../API\";\r\nimport { Link } from \"react-router-dom\";\r\nimport withDataContainer from \"../../../HOC/withData\";\r\nimport Spinner from \"../../shared/spinner/spinner\";\r\n\r\nconst BlockEventNotification = (props: any) => {\r\n  const { event, poll } = props;\r\n\r\n  const [willGo, setWillGo] = useState<boolean | undefined>(false);\r\n  const [willNotGo, setWillNotGo] = useState<boolean | undefined>(false);\r\n\r\n  const [missedDeadline, setMissedDeadline] = useState(false);\r\n  const [correctPollId, setCorrectPollId] = useState<any>(0);\r\n  let deadline = new Date(event.deadline);\r\n  let startDate = new Date(event.start);\r\n  let today = new Date();\r\n\r\n  function submitPoll(finalAnswer: boolean) {\r\n    const data = {\r\n      event: event.id,\r\n      answer: finalAnswer,\r\n    };\r\n    if (correctPollId) {\r\n      API.patchPoll(data, correctPollId);\r\n    } else {\r\n      API.postPoll(data).then((data) => {\r\n        setCorrectPollId(data.data.id);\r\n      });\r\n    }\r\n  }\r\n  const handleWillGo = () => {\r\n    setWillGo(true);\r\n    setWillNotGo(false);\r\n    submitPoll(true);\r\n  };\r\n  const handleWillNotGo = () => {\r\n    setWillGo(false);\r\n    setWillNotGo(true);\r\n    submitPoll(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    // get data to poll if it exist\r\n    API.getMyPoll().then((data) => {\r\n      if (data.data) {\r\n        let correctPoll: any = [];\r\n        correctPoll = data.data.filter((poll: any) => {\r\n          return poll.event === event.title;\r\n        });\r\n        // if exist fill correct data in inputs\r\n        if (correctPoll[0]) {\r\n          correctPoll[0].answer ? setWillGo(true) : setWillNotGo(true);\r\n          setCorrectPollId(correctPoll[0].id);\r\n        }\r\n      }\r\n    });\r\n    // disable input if deadline crossed\r\n    if (+today.getTime() > +deadline.getTime()) {\r\n      setMissedDeadline(true);\r\n    } else {\r\n      setMissedDeadline(false);\r\n    }\r\n  }, [poll, correctPollId]);\r\n\r\n  return (\r\n    <div className=\"notifications__content\">\r\n      <div className=\"notifications__content-image-wrapper\">\r\n        <img\r\n          className=\"notifications__content-image\"\r\n          src={event.image || eventImage}\r\n          // src={eventImage}\r\n          alt=\"event\"\r\n        />\r\n      </div>\r\n      <div className=\"notifications__content-block\">\r\n        <p className=\"notifications__content-date\">\r\n          {(startDate.getHours() < 10 ? \"0\" : \"\") + startDate.getHours()}.\r\n          {(startDate.getMinutes() < 10 ? \"0\" : \"\") + startDate.getMinutes()}{\" \"}\r\n          {props.days[startDate.getDay()]},{\" \"}\r\n          {props.monthListRus[startDate.getMonth()]} {startDate.getDate()}\r\n        </p>\r\n        <p className=\"notifications__content-title\">{event.title}</p>\r\n        <p className=\"notifications__content-description\">\r\n          {event.description}\r\n        </p>\r\n        <p className=\"notifications__content-address\">\r\n          <img\r\n            className=\"notifications__content-address-image\"\r\n            src={address}\r\n            alt=\"address\"\r\n          />\r\n          Адрес: {event.place.name || event.address}\r\n        </p>\r\n      </div>\r\n      <div className=\"notifications__content-buttons\">\r\n        <Link to={`/today/${event.id}`} className=\"link\">\r\n          <button className=\"button notifications__content-button notifications__content-button_blue\">\r\n            Подробнее\r\n          </button>\r\n        </Link>\r\n        {correctPollId ? (\r\n          willGo ? (\r\n            <button\r\n              onClick={handleWillNotGo}\r\n              className=\"button notifications__content-button notifications__content-button_cyan\"\r\n            >\r\n              Я пойду\r\n            </button>\r\n          ) : (\r\n            <button\r\n              onClick={handleWillGo}\r\n              className=\"button notifications__content-button notifications__content-button_red\"\r\n            >\r\n              Я не пойду\r\n            </button>\r\n          )\r\n        ) : (\r\n          <button\r\n            onClick={handleWillGo}\r\n            className=\"button notifications__content-button notifications__content-button_red\"\r\n          >\r\n            Я не пойду\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Notification = (props: any) => {\r\n  const filters = [\r\n    { value: \"day\", label: \"День\" },\r\n    { value: \"week\", label: \"Неделя\" },\r\n    { value: \"month\", label: \"Месяц\" },\r\n    { value: \"\", label: \"Все\" },\r\n  ];\r\n  const [events, setEvents] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [period, setPeriod] = useState(\"\");\r\n  const [myPoll, setMyPoll] = useState<any>({});\r\n\r\n  // pagination\r\n  const [currentPage, setCurrentPage] = useState(0);\r\n  const [pageSize, setPageSize] = useState(6);\r\n  const [totalProducts, setTotalProducts] = useState(0);\r\n  const [portionSize, setPortionSize] = useState(5);\r\n  const [next, setNext] = useState<string | null>(\"\");\r\n  let pagesCount = Math.ceil(totalProducts / pageSize);\r\n  let pages = [];\r\n  for (let i = 1; i <= pagesCount; i++) {\r\n    pages.push(i);\r\n  }\r\n  let portionCount = Math.ceil(pagesCount / portionSize);\r\n  let [portionNumber, setPortionNumber] = useState(1);\r\n  let leftPortionPageNumber = (portionNumber - 1) * portionSize + 1;\r\n  let rightPortionPageNumber = portionNumber * portionSize;\r\n\r\n  useEffect(() => {\r\n    API.getEvents(pageSize, currentPage * pageSize, search, period).then(\r\n      (data) => {\r\n        setEvents(data.data.results);\r\n        setTotalProducts(data.data.count);\r\n        setNext(data.data.next);\r\n      }\r\n    );\r\n\r\n    // get data to poll if it exist\r\n    API.getMyPoll().then((data) => {\r\n      setMyPoll(data.data);\r\n    });\r\n  }, [pageSize, currentPage, search, period]);\r\n\r\n  return (\r\n    <div className=\"wrapper wrapper_bg_grey\">\r\n      <Navbar />\r\n      <div className=\"content__wrapper\">\r\n        <Spinner timeOut={1500} />\r\n        <div className=\"notifications\">\r\n          <PageTitle text=\"Уведомления\" />\r\n          <div className=\"notifications__buttons\">\r\n            <input\r\n              className=\"notifications__buttons-search\"\r\n              type=\"text\"\r\n              name=\"search\"\r\n              id=\"search\"\r\n              placeholder=\"Искать...\"\r\n              onChange={(event) => {\r\n                setSearch(event.target.value);\r\n              }}\r\n            />\r\n            <Select\r\n              options={filters}\r\n              className=\"notifications__buttons-select\"\r\n              onChange={(e: any) => {\r\n                setPeriod(e.value);\r\n              }}\r\n              placeholder=\"Выберите период\"\r\n            />\r\n          </div>\r\n\r\n          <section className=\"notifications__section\">\r\n            <div className=\"notifications__section-arrow \">\r\n              <img\r\n                onClick={() => {\r\n                  return currentPage > 0\r\n                    ? setCurrentPage(currentPage - 1)\r\n                    : null;\r\n                }}\r\n                className=\"rotate_180\"\r\n                src={notificationArrow}\r\n                alt=\"arrow\"\r\n              />\r\n            </div>\r\n            <div className=\"notifications__section-content\">\r\n              {events\r\n                ? events.map((event: any) => {\r\n                    return (\r\n                      <BlockEventNotification\r\n                        key={event.id}\r\n                        poll={myPoll}\r\n                        event={event}\r\n                        {...props}\r\n                      />\r\n                    );\r\n                  })\r\n                : null}\r\n            </div>\r\n            <div className=\"notifications__section-arrow\">\r\n              <img\r\n                onClick={() => {\r\n                  return next ? setCurrentPage(currentPage + 1) : null;\r\n                }}\r\n                src={notificationArrow}\r\n                alt=\"arrow\"\r\n              />\r\n            </div>\r\n          </section>\r\n\r\n          <div\r\n            className=\"notifications__pagination\"\r\n            style={{ margin: \"0 0 40px 0\" }}\r\n          >\r\n            <div className=\"notifications__pagination-content\">\r\n              {portionNumber > 1 && (\r\n                <div\r\n                  onClick={() => {\r\n                    setPortionNumber(portionNumber - 1);\r\n                  }}\r\n                  className=\"notifications__pagination-content-arrow\"\r\n                >\r\n                  &#10094;\r\n                </div>\r\n              )}\r\n              {pages\r\n                .filter(\r\n                  (p) =>\r\n                    p >= leftPortionPageNumber && p <= rightPortionPageNumber\r\n                )\r\n                .map((page) => {\r\n                  return (\r\n                    <div\r\n                      key={page}\r\n                      onClick={() => {\r\n                        setCurrentPage(page - 1);\r\n                      }}\r\n                      className={\r\n                        page === currentPage + 1\r\n                          ? \"notifications__pagination-content-number number_active\"\r\n                          : \"notifications__pagination-content-number\"\r\n                      }\r\n                    >\r\n                      <p className=\"notifications__pagination-content-number-value\">\r\n                        {page}\r\n                      </p>\r\n                    </div>\r\n                  );\r\n                })}\r\n\r\n              {portionCount > portionNumber && (\r\n                <div\r\n                  onClick={() => {\r\n                    setPortionNumber(portionNumber + 1);\r\n                  }}\r\n                  className=\"notifications__pagination-content-arrow\"\r\n                >\r\n                  &#10095;\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withDataContainer(Notification);\r\n","import Notification from './notifications.tsx';\r\n\r\nexport default Notification;"],"sourceRoot":""}