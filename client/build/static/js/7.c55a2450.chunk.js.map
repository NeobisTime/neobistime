{"version":3,"sources":["../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","images/pages/authentication.svg","images/pages/password_eye.svg","components/pages/auth/auth.tsx","components/pages/auth/index.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","module","exports","Authorization","props","useState","email","setEmail","password","setPassword","hidden1","setHidden1","emailError","errors","setErrors","validate","test","alertType","setAlertType","alertText","setAlertText","isAlertOpen","setIsAlertOpen","openAlert","response","status","setTimeout","event","a","preventDefault","data","API","postAuthData","then","requestDataToPush","token","getCookie","getRole","is_staff","document","cookie","localStorage","setItem","history","window","location","reload","catch","error","request","className","onSubmit","htmlFor","type","name","required","onChange","onBlur","style","height","minLength","onClick","src","eye","alt","to","designPhoto","text","onClose"],"mappings":"4GAAe,SAASA,EAAgBC,EAAKC,EAAKC,GAYhD,OAXID,KAAOD,EACTG,OAAOC,eAAeJ,EAAKC,EAAK,CAC9BC,MAAOA,EACPG,YAAY,EACZC,cAAc,EACdC,UAAU,IAGZP,EAAIC,GAAOC,EAGNF,ECVT,SAASQ,EAAQC,EAAQC,GACvB,IAAIC,EAAOR,OAAOQ,KAAKF,GAEvB,GAAIN,OAAOS,sBAAuB,CAChC,IAAIC,EAAUV,OAAOS,sBAAsBH,GACvCC,IAAgBG,EAAUA,EAAQC,QAAO,SAAUC,GACrD,OAAOZ,OAAOa,yBAAyBP,EAAQM,GAAKV,eAEtDM,EAAKM,KAAKC,MAAMP,EAAME,GAGxB,OAAOF,EAGM,SAASQ,EAAeC,GACrC,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACzC,IAAIG,EAAyB,MAAhBF,UAAUD,GAAaC,UAAUD,GAAK,GAE/CA,EAAI,EACNb,EAAQL,OAAOqB,IAAS,GAAMC,SAAQ,SAAUxB,GAC9C,EAAemB,EAAQnB,EAAKuB,EAAOvB,OAE5BE,OAAOuB,0BAChBvB,OAAOwB,iBAAiBP,EAAQjB,OAAOuB,0BAA0BF,IAEjEhB,EAAQL,OAAOqB,IAASC,SAAQ,SAAUxB,GACxCE,OAAOC,eAAegB,EAAQnB,EAAKE,OAAOa,yBAAyBQ,EAAQvB,OAKjF,OAAOmB,E,uDCjCTQ,EAAOC,QAAU,IAA0B,4C,oBCA3CD,EAAOC,QAAU,IAA0B,0C,8LCyK5BC,EAjKiB,SAACC,GAAgB,IAAD,EACpBC,mBAAiB,IADG,mBACvCC,EADuC,KAChCC,EADgC,OAEdF,mBAAiB,IAFH,mBAEvCG,EAFuC,KAE7BC,EAF6B,OAGhBJ,oBAAkB,GAHF,mBAGvCK,EAHuC,KAG9BC,EAH8B,OAclBN,mBAAS,CACnCO,WAAY,KAfgC,mBAcvCC,EAduC,KAc/BC,EAd+B,KAiBxCC,EAAW,WACf,IAAMF,EAAS,CACbD,WAAY,IAOd,MALK,4CAA4CI,KAAKV,GAGpDQ,EAAU,eAAKD,EAAN,CAAcD,WAAY,MAFnCE,EAAU,eAAKD,EAAN,CAAcD,WAAY,oFAI9BC,GA1BqC,EA6BZR,mBAAS,WA7BG,mBA6BvCY,EA7BuC,KA6B5BC,EA7B4B,OA8BZb,mBAAS,IA9BG,mBA8BvCc,EA9BuC,KA8B5BC,EA9B4B,OA+BVf,oBAAkB,GA/BR,mBA+BzCgB,EA/ByC,KA+B5BC,EA/B4B,KAmCxCC,EAAY,SAACC,GACbA,EAASC,QAAU,KAAOD,EAASC,QAAU,KAC/CP,EAAa,WACbE,EAAa,2FAEbF,EAAa,SACbE,EAAaI,EAASA,UAAY,8HAEpCF,GAAe,GACfI,YAAW,WACTJ,GAAe,KACd,MA9CyC,4CAiD9C,WAA4BK,GAA5B,eAAAC,EAAA,6DACED,EAAME,iBACAC,EAAO,CAAExB,QAAOE,YACtBO,IAHF,SAKqBgB,IAAIC,aAAaF,GACjCG,MAAK,SAACT,GACLD,EAAUC,GACV,IACIU,EAAyB,CAC3BC,MAFkBC,YAAU,eAAiB,IAI/CL,IAAIM,QAAQH,GAAmBD,MAAK,SAACH,GAC/BA,EAAKA,KAAKQ,UACZC,SAASC,OAAT,cACAC,aAAaC,QAAQ,OAAQ,SAC7BtC,EAAMuC,QAAQrD,KAAK,KACnBsD,OAAOC,SAASC,QAAO,KAEvBP,SAASC,OAAT,aACAC,aAAaC,QAAQ,OAAQ,QAC7BtC,EAAMuC,QAAQrD,KAAK,KACnBsD,OAAOC,SAASC,QAAO,UAI5BC,OAAM,SAACC,GACNzB,EAAUyB,EAAMC,YA3BtB,0DAjD8C,sBAgF9C,OACE,yBAAKC,UAAU,QACb,yBAAKA,UAAU,iBACb,yBAAKA,UAAU,eACb,uBAAGA,UAAU,oBAAb,kHACA,uBAAGA,UAAU,2BAAb,4IAEF,6BAASA,UAAU,iBACjB,0BAAMA,UAAU,aAAaC,SAxFS,6CAyFpC,2BAAOD,UAAU,cAAcE,QAAQ,SAAvC,UAGA,2BACEF,UAAU,cACVG,KAAK,OACLC,KAAK,QACLC,UAAQ,EACRhF,MAAO+B,EACPkD,SA7Fc,SAAC7B,GACzBpB,EAASoB,EAAMlC,OAAOlB,OACtBwC,KA4FU0C,OAAQ1C,IAETF,GAAU,yBAAKqC,UAAU,eAAerC,EAAOD,YAEhD,2BAAOsC,UAAU,cAAcE,QAAQ,YAAvC,wCAGA,yBAAKF,UAAU,yBAAyBQ,MAAO,CAAEC,OAAQ,SACvD,2BACET,UAAU,+BACVG,KAAM3C,EAAU,WAAa,OAC7BkD,UAAW,EACXN,KAAK,WACLC,UAAQ,EACRhF,MAAOiC,EACPgD,SAxGe,SAAC7B,GAC5BlB,EAAYkB,EAAMlC,OAAOlB,UAyGf,yBACEsF,QAAS,WACPlD,GAAYD,IAEdoD,IAAKC,IACLC,IAAI,MACJd,UAAU,kCAGd,yBAAKA,UAAU,uBACb,0BAAMA,UAAU,yBAAhB,8EACA,kBAAC,IAAD,CAAMe,GAAG,sBACP,0BAAMf,UAAU,0BAAhB,8EAGJ,yBAAKA,UAAU,gDACb,4BAAQA,UAAU,eAAeG,KAAK,UAAtC,kCAGA,0BAAMH,UAAU,oDAAhB,2FAGA,kBAAC,IAAD,CAAMe,GAAG,iBACP,0BAAMf,UAAU,sDAAhB,oHAOR,6BAASA,UAAU,iBACjB,yBACEY,IAAKI,IACLhB,UAAU,cACVc,IAAI,2BAGP3C,GACC,kBAAC,IAAD,CAAOgC,KAAMpC,EAAWkD,KAAMhD,EAAWiD,QA1HzB,WACtB9C,GAAgBD,SCvCLlB","file":"static/js/7.c55a2450.chunk.js","sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","module.exports = __webpack_public_path__ + \"static/media/authentication.3c0df457.svg\";","module.exports = __webpack_public_path__ + \"static/media/password_eye.66ec5002.svg\";","import React, { useState } from \"react\";\r\nimport designPhoto from \"../../../images/pages/authentication.svg\";\r\nimport \"../../../styles/pages/_auth.scss\";\r\nimport { Link } from \"react-router-dom\";\r\nimport eye from \"../../../images/pages/password_eye.svg\";\r\nimport API, { getCookie } from \"../../../API\";\r\nimport Alert from \"../../shared/alert\";\r\n\r\nconst Authorization: React.FC = (props: any) => {\r\n  const [email, setEmail] = useState<string>(\"\");\r\n  const [password, setPassword] = useState<string>(\"\");\r\n  const [hidden1, setHidden1] = useState<boolean>(true);\r\n\r\n  const handleChangeEmail = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setEmail(event.target.value);\r\n    validate();\r\n  };\r\n\r\n  const handleChangePassword = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setPassword(event.target.value);\r\n  };\r\n  // validate\r\n  const [errors, setErrors] = useState({\r\n    emailError: \"\",\r\n  });\r\n  const validate = () => {\r\n    const errors = {\r\n      emailError: \"\",\r\n    };\r\n    if (!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i.test(email)) {\r\n      setErrors({ ...errors, emailError: \"Неправильный email\" });\r\n    } else {\r\n      setErrors({ ...errors, emailError: \"\" });\r\n    }\r\n    return errors;\r\n  };\r\n\r\n  const [alertType, setAlertType] = useState(\"success\");\r\n  const [alertText, setAlertText] = useState(\"\");\r\n  let [isAlertOpen, setIsAlertOpen] = useState<boolean>(false);\r\n  const toggleAlertOpen = () => {\r\n    setIsAlertOpen(!isAlertOpen);\r\n  };\r\n  const openAlert = (response: any) => {\r\n    if (response.status >= 200 && response.status <= 299) {\r\n      setAlertType(\"success\");\r\n      setAlertText(\"Проверьте почту\");\r\n    } else {\r\n      setAlertType(\"error\");\r\n      setAlertText(response.response || \"непредвиденная ошибка\");\r\n    }\r\n    setIsAlertOpen(true);\r\n    setTimeout(() => {\r\n      setIsAlertOpen(false);\r\n    }, 3000);\r\n  };\r\n\r\n  async function handleSubmit(event: any) {\r\n    event.preventDefault();\r\n    const data = { email, password };\r\n    validate();\r\n\r\n    let answer = await API.postAuthData(data)\r\n      .then((response) => {\r\n        openAlert(response);\r\n        let token: string = getCookie(\"XSRF-Token\") || \"\";\r\n        let requestDataToPush: any = {\r\n          token,\r\n        };\r\n        API.getRole(requestDataToPush).then((data: any) => {\r\n          if (data.data.is_staff) {\r\n            document.cookie = `role =admin`;\r\n            localStorage.setItem(\"role\", \"admin\");\r\n            props.history.push(\"/\");\r\n            window.location.reload(true);\r\n          } else {\r\n            document.cookie = `role =user`;\r\n            localStorage.setItem(\"role\", \"user\");\r\n            props.history.push(\"/\");\r\n            window.location.reload(true);\r\n          }\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        openAlert(error.request);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <div className=\"auth\">\r\n      <div className=\"auth__content\">\r\n        <div className=\"auth__title\">\r\n          <p className=\"auth__title-text\">Добро пожаловать в Neobis Time</p>\r\n          <p className=\"auth__title-description\">Войдите, чтобы продолжить</p>\r\n        </div>\r\n        <section className=\"auth__section\">\r\n          <form className=\"auth__form\" onSubmit={handleSubmit}>\r\n            <label className=\"auth__label\" htmlFor=\"email\">\r\n              E-mail\r\n            </label>\r\n            <input\r\n              className=\"auth__input\"\r\n              type=\"text\"\r\n              name=\"email\"\r\n              required\r\n              value={email}\r\n              onChange={handleChangeEmail}\r\n              onBlur={validate}\r\n            />\r\n            {errors && <div className=\"error__span\">{errors.emailError}</div>}\r\n\r\n            <label className=\"auth__label\" htmlFor=\"password\">\r\n              Пароль\r\n            </label>\r\n            <div className=\"registration__password\" style={{ height: \"43px\" }}>\r\n              <input\r\n                className=\"registration__password-input\"\r\n                type={hidden1 ? \"password\" : \"text\"}\r\n                minLength={8}\r\n                name=\"password\"\r\n                required\r\n                value={password}\r\n                onChange={handleChangePassword}\r\n              />\r\n              <img\r\n                onClick={() => {\r\n                  setHidden1(!hidden1);\r\n                }}\r\n                src={eye}\r\n                alt=\"eye\"\r\n                className=\"registration__password-image\"\r\n              />\r\n            </div>\r\n            <div className=\"auth__text_position\">\r\n              <span className=\"auth__text_small_grey\">Забыли пароль?</span>\r\n              <Link to=\"/recovery_password\">\r\n                <span className=\"auth__text_small_green\">Восстановить</span>\r\n              </Link>\r\n            </div>\r\n            <div className=\"auth__text_position auth__text_position_last\">\r\n              <button className=\"auth__submit\" type=\"submit\">\r\n                Войти\r\n              </button>\r\n              <span className=\"auth__text_small_grey auth__text_small_grey_last\">\r\n                Еще нет аккаунта?\r\n              </span>\r\n              <Link to=\"/registration\">\r\n                <span className=\"auth__text_small_green auth__text_small_green_last\">\r\n                  Зарегистрироваться\r\n                </span>\r\n              </Link>\r\n            </div>\r\n          </form>\r\n        </section>\r\n        <section className=\"auth__section\">\r\n          <img\r\n            src={designPhoto}\r\n            className=\"auth__image\"\r\n            alt=\"girl introducin login\"\r\n          />\r\n        </section>\r\n        {isAlertOpen && (\r\n          <Alert type={alertType} text={alertText} onClose={toggleAlertOpen} />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Authorization;\r\n","import Authorization from \"./auth.tsx\";\r\n\r\nexport default Authorization;\r\n"],"sourceRoot":""}